<div class="pricing-engine">
  <mat-card class="controls-section">
    <mat-card-header>
      <mat-card-title>Product Configuration</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="controls">
        <mat-form-field>
          <mat-label>Product</mat-label>
          <mat-select [value]="selectedProduct()" (selectionChange)="onProductChange($event)">
            <mat-option value="laptop">Gaming Laptop</mat-option>
            <mat-option value="phone">Smartphone</mat-option>
            <mat-option value="tablet">Tablet Pro</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Quantity</mat-label>
          <input matInput type="number" [value]="quantity()" (input)="onQuantityChange($event)" min="1">
        </mat-form-field>

        <mat-form-field>
          <mat-label>Customer Type</mat-label>
          <mat-select [value]="customerType()" (selectionChange)="onCustomerTypeChange($event)">
            <mat-option value="regular">Regular</mat-option>
            <mat-option value="premium">Premium</mat-option>
            <mat-option value="enterprise">Enterprise</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Manual Price Override</mat-label>
          <input matInput type="number" [value]="manualPrice() || ''" (input)="onManualPriceChange($event)" placeholder="Leave empty for auto">
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="pricing-breakdown">
    <mat-card-header>
      <mat-card-title>Pricing Breakdown</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="price-item">
        <span class="price-label">Product:</span>
        <span class="price-value">{{ getProductName() }}</span>
      </div>
      <div class="price-item">
        <span class="price-label">Base Price:</span>
        <span class="price-value">${{ getBasePrice() }}</span>
      </div>
      <div class="price-item">
        <span class="price-label">Quantity:</span>
        <span class="price-value">{{ quantity() }}</span>
      </div>
      <div class="price-item">
        <span class="price-label">Customer Discount:</span>
        <span class="price-value">{{ getDiscountText() }}</span>
      </div>
      @if (manualPrice()) {
        <div class="price-item">
          <span class="price-label">Manual Override:</span>
          <span class="price-value">${{ manualPrice() }}</span>
        </div>
      }
      <div class="price-item">
        <span class="price-label">Final Price:</span>
        <span class="price-value final-price">${{ finalPrice() }}</span>
      </div>

      <div class="current-calculation">
        <div class="calculation-title">Current Calculation:</div>
        <div class="calculation-details">
          @if (manualPrice()) {
            Manual Override: ${{ manualPrice() }}
          } @else {
            Base: ${{ getBasePrice() }} Ã— {{ quantity() }} = ${{ getBasePrice() * quantity() }}<br>
            Discount: {{ getDiscountText() }}<br>
            Final: ${{ finalPrice() }}
          }
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>
